<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Happy Holidays ðŸŽ„</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at top, #0b2d1a, #020202);
    font-family: Arial, Helvetica, sans-serif;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
  }

  .container {
    text-align: center;
    z-index: 2;
  }

  .message {
    font-size: clamp(2.5rem, 8vw, 6rem);
    font-weight: bold;
    letter-spacing: 0.2em;
  }

  .message span {
    opacity: 0;
    animation: lights var(--speed) infinite;
    animation-delay: calc(var(--i) * 0.15s);
  }

  .button {
    margin-top: 40px;
    padding: 15px 30px;
    font-size: 1.1rem;
    border: none;
    border-radius: 30px;
    background: gold;
    cursor: pointer;
    box-shadow: 0 0 20px gold;
  }

  @keyframes lights {
    0%   { color: red; text-shadow: 0 0 20px red; }
    25%  { color: gold; text-shadow: 0 0 20px gold; }
    50%  { color: lime; text-shadow: 0 0 20px lime; }
    75%  { color: cyan; text-shadow: 0 0 20px cyan; }
    100% { color: red; text-shadow: 0 0 20px red; }
  }

  /* ðŸŽ† FIREWORKS */
  .firework {
    position: fixed;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    pointer-events: none;
    animation: explode 1.2s ease-out forwards;
    border: 1px solid white;
  }

  @keyframes explode {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: translate(var(--x), var(--y)) scale(0);
      opacity: 0;
    }
  }
</style>
</head>

<body>

<div class="container">
  <div class="message">
    <span style="--i:0">H</span>
    <span style="--i:1">A</span>
    <span style="--i:2">P</span>
    <span style="--i:3">P</span>
    <span style="--i:4">Y</span>
    <br><br>
    <span style="--i:5">H</span>
    <span style="--i:6">O</span>
    <span style="--i:7">L</span>
    <span style="--i:8">I</span>
    <span style="--i:9">D</span>
    <span style="--i:10">A</span>
    <span style="--i:11">Y</span>
    <span style="--i:12">S</span>
  </div>

  <button class="button" onclick="startShow()">ðŸŽ„ Turn on the Lights</button>
</div>

<audio id="music" loop>
  <source src="deck-the-halls-rock.mp3" type="audio/mpeg">
</audio>

<script>
let speed = 2;

function startShow() {
  const music = document.getElementById('music');

  document.querySelectorAll('.message span').forEach(span => {
    span.style.opacity = 1;
    span.style.setProperty('--speed', speed + 's');
  });

  // Play music after user interaction
  music.volume = 0;
  music.play().then(() => {
    let v = 0;
    const fade = setInterval(() => {
      v += 0.05;
      music.volume = Math.min(v, 1);
      if (v >= 1) clearInterval(fade);
    }, 200);
  }).catch(e => {
    console.log('Audio play was prevented:', e);
  });

  rhythmEngine();
  fireworksEngine();
}

// ðŸŽµ Light rhythm engine
function rhythmEngine() {
  setInterval(() => {
    const burst = Math.random() > 0.6;
    speed = burst ? (Math.random() * 0.5 + 0.6) : (Math.random() * 1.5 + 1.5);

    document.querySelectorAll('.message span').forEach(span => {
      span.style.setProperty('--speed', speed + 's');
    });
  }, 3000);
}

// ðŸŽ† Fireworks engine with debug logs
function fireworksEngine() {
  setInterval(() => {
    console.log('fireworksEngine running, speed:', speed);
    if (speed < 1) {
      launchFirework();
      launchFirework();
    } else if (Math.random() > 0.7) {
      launchFirework();
    }
  }, 600);
}

function launchFirework() {
  console.log('launchFirework called');
  const colors = ['red', 'gold', 'lime', 'cyan', 'magenta', 'orange'];
  const x = Math.random() * window.innerWidth;
  const y = Math.random() * window.innerHeight * 0.5 + 100;

  console.log('Firework launched at', x, y);

  for (let i = 0; i < 30; i++) {
    const spark = document.createElement('div');
    spark.className = 'firework';
    spark.style.left = x + 'px';
    spark.style.top = y + 'px';
    spark.style.background = colors[Math.floor(Math.random() * colors.length)];
    spark.style.setProperty('--x', (Math.random() - 0.5) * 300 + 'px');
    spark.style.setProperty('--y', (Math.random() - 0.5) * 300 + 'px');

    document.body.appendChild(spark);
    setTimeout(() => spark.remove(), 1200);
  }
}
</script>

</body>
</html>
